# -----------------------------------------------------------------------------
# Adapter and target configuration for STM32H5x
# -----------------------------------------------------------------------------

# 1. Specify the debug adapter driver
adapter driver st-link

# 2. Use SWD (not JTAG)
transport select dapdirect_swd

# 3. Set SWD clock speed (adjust if needed)
adapter speed 4000

# 4. Load the STM32H5 target configuration
source [find board/stm32h5x.cfg]

# -----------------------------------------------------------------------------
# ITM / SWO configuration
# -----------------------------------------------------------------------------
init
reset halt

stm32h5x.tpiu configure -protocol uart -traceclk 32000000 -output :3344 -formatter off
stm32h5x.tpiu enable